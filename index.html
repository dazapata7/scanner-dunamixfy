function doPost(e) {
  try {
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    
    // Recibir datos del formulario
    var operario = e.parameter.operario;
    var codigo = e.parameter.codigo;
    var fecha = new Date();
    
    // Agregar fila
    sheet.appendRow([fecha, operario, codigo]);
    
    return ContentService.createTextOutput('success');
    
  } catch(error) {
    Logger.log('Error: ' + error.toString());
    return ContentService.createTextOutput('error: ' + error.toString());
  }
}

function doGet() {
  return ContentService.createTextOutput("Sistema de escaneo activo");
}
